//////////////////////////////////////////////////////////////////////
//====================================================================
//
//	使い魔スクリプト専用インクルードライブラリ
//
//		※使い魔スクリプト以外からは使用出来ません。
//			それ以外からはインクルードしないでください。
//
//====================================================================
//////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////
//--------------------------------------------------------------------
//	下位ライブラリをインクルード
//--------------------------------------------------------------------
//////////////////////////////////////////////////////////////////////
#include_function ".\INCLUDE\EnemyShadow.dnh"


//////////////////////////////////////////////////////////////////////
//--------------------------------------------------------------------
//	定数
//--------------------------------------------------------------------
//////////////////////////////////////////////////////////////////////

let SHADOW_TIMELAG = 8;	//	切り替わりのタイムラグ


//////////////////////////////////////////////////////////////////////
//--------------------------------------------------------------------
//	メンバ変数
//--------------------------------------------------------------------
//////////////////////////////////////////////////////////////////////

let m_nChangeTime = 0;	//	最後に切り替わった時間
let m_bHidden = false;	//	隠蔽中か否か


//////////////////////////////////////////////////////////////////////
//--------------------------------------------------------------------
//	判定関数
//--------------------------------------------------------------------
//////////////////////////////////////////////////////////////////////

//	タイムラグ時間終了したか否かを返す
function IsElapsedTimeLag(){ return m_nCount - m_nChangeTime > SHADOW_TIMELAG; }


//////////////////////////////////////////////////////////////////////
//--------------------------------------------------------------------
//	未分類
//--------------------------------------------------------------------
//////////////////////////////////////////////////////////////////////

//	死亡時に特定半径の弾を消す
function DestructShadow( let fRadius ){
	if( !BeVanished() ){ DeleteEnemyShotToItemInCircle( SHOT, GetX(), GetY(), fRadius ); }
	DeleteEnemyShotToItemInCircle( ALL, GetX(), GetY(), 0 );
}

//	基本処理
//	※@MainLoopの最後に毎回呼び出してください
function BehaviorShadow( let szSEHiddenFile, let szSESuddenFile ){
	alternative( GetKeyState( VK_SLOWMOVE ) )
	case( KEY_PUSH ){
		PlaySE( szSEHiddenFile );
		m_nChangeTime = m_nCount;
	}
	case( KEY_PULL ){
		PlaySE( szSESuddenFile );
		m_nChangeTime = m_nCount;
	}
	case( KEY_HOLD ){ if( IsElapsedTimeLag() ){ m_bHidden = true; } }
	case( KEY_FREE ){ if( IsElapsedTimeLag() ){ m_bHidden = false; } }
}
