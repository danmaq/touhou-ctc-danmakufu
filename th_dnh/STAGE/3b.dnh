//////////////////////////////////////////////////////////////////////
//====================================================================
//
//	東方夢終劇 〜 Concealed the Conclusion
//		STAGE 3b
//
//		※ステージライブラリから自動的にインクルードされます
//
//====================================================================
//////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////
//--------------------------------------------------------------------
//	メンバ変数
//--------------------------------------------------------------------
//////////////////////////////////////////////////////////////////////

let m_aszStage3BLoadFileListGraphic = [];
let m_aszStage3BLoadFileListEnemy = [];
let m_aszStage3BLoadFileListSound = [];


//////////////////////////////////////////////////////////////////////
//--------------------------------------------------------------------
//	内部処理
//--------------------------------------------------------------------
//////////////////////////////////////////////////////////////////////

//	初期化
function Stage3BInitialize(){
	SetCommonData("Level",m_nStageLevel);
	SetCommonData("DeleteEnemy",0);
	LoadProgress( m_aszStageDefaultLoadFileListGraphic ~ m_aszStage3BLoadFileListGraphic, m_aszStage3BLoadFileListEnemy, m_aszStageDefaultLoadFileListSE ~ m_aszStage3BLoadFileListSound );
}

//	ここにステージの中身を書く
task Stage3B(){

	_Wait(200);

//---------------------------------------------------------------

	CreateEnemyFromFile(z_g_07,GetCenterX(),GetClipMinY()-20,3,90,0);
	_Wait(500);

	loop(2)
	{
		loop([8,5,4,3][m_nStageLevel])
		{
			CreateEnemyFromFile(z_s_06,GetClipMinX()-20,GetCenterY()/2,2.5,0,0);
			_Wait(int(130/[8,5,4,3][m_nStageLevel]));
		}
		loop([8,5,4,3][m_nStageLevel])
		{
			CreateEnemyFromFile(z_s_06,GetClipMaxX()+20,GetCenterY()/2,2.5,180,0);
			_Wait(int(130/[8,5,4,3][m_nStageLevel]));
		}
	}
	_Wait(100);

//---------------------------------------------------------------

	CreateEnemyFromFile(z_g_08,GetCenterX(),GetClipMinY()-20,3,90,0);
	_Wait(500);

	loop(2)
	{
		loop([8,5,4,3][m_nStageLevel])
		{
			CreateEnemyFromFile(z_s_06,GetCenterX()*1.5,GetClipMinY()-20,2.5,90,0);
			_Wait(int(130/[8,5,4,3][m_nStageLevel]));
		}
		loop([8,5,4,3][m_nStageLevel])
		{
			CreateEnemyFromFile(z_s_06,GetCenterX()/2,GetClipMinY()-20,2.5,90,0);
			_Wait(int(130/[8,5,4,3][m_nStageLevel]));
		}
	}
	_Wait(100);

//---------------------------------------------------------------

	CreateEnemyFromFile(z_g_09,GetCenterX(),GetClipMinY()-20,3,90,0);
	_Wait(300);

	loop(2)
	{
		loop([8,5,4,3][m_nStageLevel])
		{
			CreateEnemyFromFile(z_s_06,GetCenterX()*1.5,GetClipMinY()-20,2.5,90,0);
			_Wait(int(130/[8,5,4,3][m_nStageLevel]));
		}
		loop([8,5,4,3][m_nStageLevel])
		{
			CreateEnemyFromFile(z_s_06,GetCenterX()/2,GetClipMinY()-20,2.5,90,0);
			_Wait(int(130/[8,5,4,3][m_nStageLevel]));
		}
	}
	_Wait(100);

//---------------------------------------------------------------

	DeleteEnemyShotToItem(ALL);
	SetCommonData("DeleteEnemy",1);


///////////////////////////////////////////////////////////////////////
//ここに中ボスが入る
	_Wait(100);
///////////////////////////////////////////////////////////////////////

	SetCommonData("DeleteEnemy",0);
	_Wait(200);

//---------------------------------------------------------------

	CreateEnemyFromFile(z_m_11,GetCenterX(),GetClipMinY()-20,3.5,90,0);
	_Wait(300);

	loop(2)
	{
		loop([8,5,4,3][m_nStageLevel])
		{
			CreateEnemyFromFile(z_s_06,GetCenterX()*1.5,GetClipMinY()-20,2.5,90,0);
			_Wait(int(130/[8,5,4,3][m_nStageLevel]));
		}
		loop([8,5,4,3][m_nStageLevel])
		{
			CreateEnemyFromFile(z_s_06,GetCenterX()/2,GetClipMinY()-20,2.5,90,0);
			_Wait(int(130/[8,5,4,3][m_nStageLevel]));
		}
	}
	_Wait(100);

//---------------------------------------------------------------

	CreateEnemyFromFile(z_g_10,GetCenterX()/2,GetClipMinY()-20,3.5,90,0);
	CreateEnemyFromFile(z_g_10,GetCenterX()*1.5,GetClipMinY()-20,3.5,90,0);
	_Wait(1000);

	DeleteEnemyShotToItem(ALL);
	SetCommonData("DeleteEnemy",1);
	_Wait(10);
	SetCommonData("DeleteEnemy",0);


///////////////////////////////////////////////////////////////////////
//ここにボスが入る
	_Wait(100);
///////////////////////////////////////////////////////////////////////



//ショットキーを押すと次のステージへ////////////////
	while(GetKeyState(VK_SHOT) != KEY_PUSH)
	{
		yield;
	}
////////////////////////////////////////////////////






	Stage4();
}


//////////////////////////////////////////////////////////////////////
//--------------------------------------------------------------------
//	メイン部
//--------------------------------------------------------------------
//////////////////////////////////////////////////////////////////////

//	@MainLoop()にて毎フレーム呼ばれる部分
function Stage3BMainLoop(){
}

//	@BackGround()にて毎回呼ばれる部分
function Stage3BDrawBackGround(){
}

//	@DrawBottomObject()にて毎回呼ばれる部分
function Stage3BDrawBottomObject(){
}

//	@DrawTopObject()にて毎回呼ばれる部分
function Stage3BDrawTopObject(){
}
