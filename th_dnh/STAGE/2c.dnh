//////////////////////////////////////////////////////////////////////
//====================================================================
//
//	東方夢終劇 〜 Concealed the Conclusion
//		STAGE 2c
//
//		※ステージライブラリから自動的にインクルードされます
//
//====================================================================
//////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////
//--------------------------------------------------------------------
//	メンバ変数
//--------------------------------------------------------------------
//////////////////////////////////////////////////////////////////////

let m_aszStage2CLoadFileListGraphic = [];
let m_aszStage2CLoadFileListEnemy = [];
let m_aszStage2CLoadFileListSound = [];


//////////////////////////////////////////////////////////////////////
//--------------------------------------------------------------------
//	内部処理
//--------------------------------------------------------------------
//////////////////////////////////////////////////////////////////////

//	初期化
function Stage2CInitialize(){
	LoadProgress( m_aszStageDefaultLoadFileListGraphic ~ m_aszStage2CLoadFileListGraphic, m_aszStage2CLoadFileListEnemy, m_aszStageDefaultLoadFileListSE ~ m_aszStage2CLoadFileListSound );
	SetCommonData("Level",m_nStageLevel);
	SetCommonData("DeleteEnemy",0);
}

//	ここにステージの中身を書く
task Stage2C(){

	_Wait(100);

//---------------------------------------------------------------

	loop(2)
	{
		loop(8)
		{
			CreateEnemyFromFile(z_o_02,GetCenterX()*1.5+rand(-50,+50),GetClipMaxY()+20,rand(4,7),-90+rand(-30,0),0);
		}
		_Wait(200);
		loop(8)
		{
			CreateEnemyFromFile(z_o_02,GetCenterX()/2+rand(-50,+50),GetClipMaxY()+20,rand(4,7),-90+rand(0,30),0);
		}
		_Wait(200);
	}
	_Wait(300);

//---------------------------------------------------------------

	loop(8)
	{
		CreateEnemyFromFile(z_s_03,GetCenterX()*1.5+rand(-50,+50),GetClipMinY()-20,rand(2,4),90+rand(0,30),[0,1][rand(0,100)<50]);
		_Wait(16);
	}

	_Wait(100);

	loop(8)
	{
		CreateEnemyFromFile(z_s_03,GetCenterX()/2+rand(-50,+50),GetClipMinY()-20,rand(2,4),90+rand(-30,0),[0,1][rand(0,100)<50]);
		_Wait(16);
	}

	_Wait(300);

//---------------------------------------------------------------

	CreateEnemyFromFile(z_m_10,GetCenterX()/2,GetClipMinY()-20,3,90,0);
	_Wait(400);
	CreateEnemyFromFile(z_m_10,GetCenterX()*1.5,GetClipMinY()-20,3,90,1);
	_Wait(550);

//---------------------------------------------------------------

	ascent(i in 0..10)
	{
		CreateEnemyFromFile(z_o_02,GetClipMinX()+20,GetCenterY()/3,Smooth(1.5,4.5,i,9),Smooth(80,0,i,9),0);
		_Wait(10);
		i++;
	}
	if(m_nStageLevel>1)
	{
		loop(6)
		{
			CreateEnemyFromFile(z_g_20,GetCenterX()+rand(-100,+100),GetClipMinY()-20,rand(3,5),90+rand(-30,30),0);
		}
	}

	_Wait(150);

	ascent(i in 0..10)
	{
		CreateEnemyFromFile(z_o_02,GetClipMaxX()-20,GetCenterY()/3,Smooth(1.5,4.5,i,9),Smooth(100,180,i,9),0);
		_Wait(10);
		i++;
	}
	if(m_nStageLevel>1)
	{
		loop(6)
		{
			CreateEnemyFromFile(z_g_20,GetCenterX()+rand(-100,+100),GetClipMinY()-20,rand(3,5),90+rand(-30,30),0);
		}
	}


	_Wait(550);
	DeleteEnemyShotToItem(ALL);
	SetCommonData("DeleteEnemy",1);


///////////////////////////////////////////////////////////////////////
//ここに中ボスが入る
	_Wait(100);
///////////////////////////////////////////////////////////////////////



	SetCommonData("DeleteEnemy",0);
	_Wait(200);

//---------------------------------------------------------------

	CreateEnemyFromFile(z_o_04,GetCenterX(),GetCenterY(),0,0,0);

	_Wait(500);

//---------------------------------------------------------------

	loop(10)
	{
		CreateEnemyFromFile(z_s_03,GetCenterX()+rand(-70,+70),GetClipMinY()-20,rand(2,4),90+rand(-10,10),[0,1][rand(0,100)<50]);
		_Wait(20);
	}

	_Wait(200);//sum=400


	loop(2)
	{
		CreateEnemyFromFile(z_m_10,GetCenterX(),GetClipMinY()-20,3,90,0);
		_Wait(300);
	}
	//sum=600

	loop([10,15,23,30][m_nStageLevel])
	{
		CreateEnemyFromFile(z_o_02,GetCenterX(),GetCenterY(),rand(0.5,3),rand(-150,-30),0);
		_Wait(800/[10,15,23,30][m_nStageLevel]);
	}
	_Wait(300);//sum=1100

	CreateEnemyFromFile(z_m_10,GetCenterX(),GetClipMinY()-20,3,90,0);
	_Wait(500);

	SetCommonData("DeleteEnemy",1);
	yield;
	DeleteEnemyShotToItem(ALL);
	SetCommonData("DeleteEnemy",0);


///////////////////////////////////////////////////////////////////////
//ここにボスが入る
	_Wait(100);
///////////////////////////////////////////////////////////////////////



//ショットキーを押すと次のステージへ////////////////
	while(GetKeyState(VK_SHOT) != KEY_PUSH)
	{
		yield;
	}
////////////////////////////////////////////////////


	Stage3();
}


//////////////////////////////////////////////////////////////////////
//--------------------------------------------------------------------
//	メイン部
//--------------------------------------------------------------------
//////////////////////////////////////////////////////////////////////

//	@MainLoop()にて毎フレーム呼ばれる部分
function Stage2CMainLoop(){
}

//	@BackGround()にて毎回呼ばれる部分
function Stage2CDrawBackGround(){
}

//	@DrawBottomObject()にて毎回呼ばれる部分
function Stage2CDrawBottomObject(){
}

//	@DrawTopObject()にて毎回呼ばれる部分
function Stage2CDrawTopObject(){
}
